<html><body>
<h3>[13] IMPORT EXPORT </h3>
When you are done, export the survey in your favourite format and make a zip archive.<br>
After you have downloaded the zip to your PC and unzipped it, you can complete the cave map with whatever program you are used to.<br><p>

The zip archive contains the command to restore the survey data and other information in the database.
The zip archive is a complete backup of your survey and its exports. You can use it to transfer the survey to another Android.<br><p>

Survey data, and zip archive, are exported from the survey <u>info window</u>.<br>
Survey sketches are exported from the <u>sketch window</u> (single sketch) and from the <u>overview window</u> (all sketches in one file).<br><p>

File for survey import are searched in the <i>import</i> folder.<br>
Zip archives for import are searched in the <i>zip</i> folder.<br><p>

<b>Default export formats</b><br>
TopoDroid has two settings to set a default export format for the survey data and one for the sketches.
By default these are both set to "none", ie, no export.
<br><p>

When the default survey data export format is set, TopoDroid exports the survey data in that format before creating a zip archive, so that the export is included in the archive.<br><p>

When the default sketch export format is set, the sketches are exported in this format whenever they are closed from the <u>sketch window</u>.<br>
For cSurvey x-sections are saved as PNG images.<br><p>

<h4>SURVEY IMPORT</h4>
TopoDroid imports survey data from the following formats:
<ul>
<li>Compass</li>
<li>Survex</li>
<li>Therion. Only data</li>
<li>VisualTopo</li>
<li>CaveSniper</li>
<li>PocketTopo, including sketches</li>
</ul>

A file import fails if a survey with the same name is already in TopoDroid.<br><p>

Zip import fails if the zip has a database version that is too old or is newer than the one in TopoDroid.<br><p>

On import from file formats that have LRUD values, these are converted to x-splays (shown in green).<br><p>


<h4>SURVEY DATA EXPORT</h4>

Note. Fixed points are exported with coordinates latitude-longitude [decimal degrees] and altitude above
mean sea level [m].<br>
H/V-splays are treated as normal splays in the exports.<br><p>

<b>Therion</b> (.th)<br>
Survey data are exported in <i>Therion</i> format, using the data "normal" form.<br>
Data units follow the user options.<br>
The team names are listed but the command is commented.<br>
Station comments and marks (fixed, painted) precede the centerline data.<br>
X-splays are exported with station "-" (dash), the others with station "." (dot).<br>
Commented shots are exported under comment (#).<br><p>

Fixed points coordinates (longitude latitude and altitude a.s.l.) are exported commented.
If the point has custom CRS coordinates, these are included as well, preceded by the CRS name.<br><p>

Furthermore "input" of the th2 files and definitions of maps for each scrap are added at the end, but are commented.<br><p>

The <i>Therion</i> export includes the calibration-check shots, as comment.<br><p>

Settings
<ul>
<li><u>Therion maps</u>: if enabled the "map" commands are placed before the survey centerline.</li>
<li>add <u>LRUD</u> to export</li>
</ul><p>

Import Therion files must have extension ".th".<br>
TopoDroid parsing of <i>Therion</i> data syntax is very limited. Basically only data in "normal" form are understood. The Therion data commands "units", "flag", "extend", "mark" and "station" are supported.<br>
Fixed points ("fix") are parsed but not taken into account as "cs" is not supported.<br><p>


<b>Compass</b> (.dat)<br>
<i>Compass</i> data file are supported both in import and in export.<br>
Import compass files must have extension either ".dat" or ".DAT".<br>
Supported data format are "normal" and "diving".<br>
Data units are 'feet' and 'degrees' (converted to meters and degrees inside TopoDroid).<br><p>

Settings:
<ul style="margin-top=0">
<li><u>Station prefix</u></li>
<li><u>splays</u></li>
<li><u>L/R swap</u></li>
</ul>
<br><p>


<b>VisualTopo</b> (.tro)<br>
<i>VisualTopo</i> data file are supported both in import and in export.<br>
Import VisualTopo files must have extension either ".tro" or ".TRO".<br>
VisualTopo splays are included if enabled.<br>
By default LRUD are at the TO station, but they can be set at the FROM station.<br> 
Data units are 'meters' and 'degrees'.<br><p>

Settings:
<ul style="margin-top=0">
<li><u>splays</u></li>
<li><u>LRUD at From</u></li>
</ul>
<br><p>


<b>Survex</b> (.svx)<br>
Survey data can be exported as <i>Survex</i> files.<br>
Data units follow the user options.<br><p>
Import Survex files must have extension ".svx".<br>

Settings:<ul style="margin-top=0">
<li><u>line termination</u> can be either Unix or Windows</li>
<li><u>named TO station</u> for splay shots (the TO name is the FROM station with a letter appended)</li>
<li>add <u>LRUD</u> to export</li>
</ul><p>


<b>cSurvey</b> (.csx)<br>
The <i>cSurvey</i> export from the survey <u>info window</u> includes only the 
survey data, and does not have any sketch.<br>
The make a <i>cSurvey</i> export with a sketch (both plan and profile),
you should export from the <u>drawing window</u>.
<br><p>

The <i>cSurvey</i> export includes the calibration-check shots and media files
(audio and photo).<br><p>


<b>TopoRobot</b> (.trb)<br>
Survey data can be exported as <i>TopoRobot</i> files. The <i>TopoRobot</i> station naming policy
must have been selected. If the station names follow TopoRobot convention "series.number", they are used.<br><p>

<b>Walls</b> (.srv)<br>
Survey data can be exported as <i>Walls</i> files (partially tested).<br>
Data units follow the user options.<br><p>

<b>WinKarst</b> (.sur)<br>
Survey data can be exported as <i>WinKarst</i> files (untested).<br><p>


<b>PocketTopo</b> (.top)<br>
TopoDroid supports <i>PocketTopo</i> both in import and in export.<br><p>

PocketTopo export contains only the survey data.<br><p>
If the station naming policy is set to "TopoRobot" and the station names follow TopoRobot convention "series.number"
these are used in the export, otherwise the names are converted to numbers.
Alphabetic characters are replaces each character with two digits. More precisely 'a' goes to '00', 'b' to '01' and so on, 'A' to '50', 'B' to '51', and so on. Every other character (i.e., non-alphanumeric) goes to '99'.<br><p>

Import PocketTopo files must have extension either ".top" or ".TOP".<br>
The "outline" and "profile" sketches are imported.
<i>PocketTopo</i> uses only a few colors to differentiate line types.
Therefore a <a href="page_pt_cmap.htm">mapping</a> from colors to TopoDroid types is used. The mapping can be changed through a setting.<br><p>

It may happen that the imported sketch is not aligned with the survey data. In this case you can shift the sketch in the
<u>sketch window</u>, to fit the centerline.<br><p>


<b>Polygon</b> (.cave)<br>
TopoDroid can export survey data in <i>Polygon</i> format. 
Fixed points are exported as lat-long.<br><p>


<b>GHTopo</b> (.gtx)<br>
TopoDroid can export survey data in <i>GHTopo</i> format (partially tested).<br><p>


<b>Grottolf</b> (.grt)<br>
TopoDroid can export survey data in <i>Grottolf</i> format (untested). 
If the first station has geographical coordinates these are exported, otherwise local coordinates are used.
The profile at the stations are computed by projecting the splay shots onto a vertical plane perpendicular to the
leg.<br><p>


<b>Topo</b> (.cav)<br>
Survey data can be exported as <i>Topo</i> files.<br><p>

Settings (under "Survex"settings):
<ul style="margin-top=0">
<li><u>line termination</u> can be either Unix or Windows</li>
</ul><p>

<b>PLT</b> (.plt)<br>
Survey data can be exported as track file (<i>OziExplorer</i>) if you have georeferenced a station.
If the survey contains disjoint pieces, the track file includes all the pieces with a georeferenced station.
Data are corrected with the magnetic declination.<br><p>

<b>KML</b> (.kml)<br>
Survey data can be exported as KML file (<i>Keyhole Markup Language</i>) if you have georeferenced at least a station.
If the survey contains disjoint pieces, the KML export includes all the pieces with a georeferenced station.
Data are corrected with the magnetic declination.<br><p>

Settings:
<ul style="margin-top=0">
<li><u>stations</u></li>
<li><u>splays</u></li>
</ul>
<br><p>

<b>GeoJSON</b> (.json)<br>
Survey data can be exported as GeoJSON file (<i>RFC 7946</i>) if you have georeferenced at least a station.
Shots are exported as <i>LineString</i>, stations as <i>Point</i>. 
If the survey contains disjoint pieces, the GeoJSON export includes all the pieces with a georeferenced station.
Data are corrected with the magnetic declination.<br><p>

Settings:
<ul style="margin-top=0">
<li><u>stations</u></li>
<li><u>splays</u></li>
</ul>
<br><p>


<b>Shapefile</b> (.shp .shx .dbf)<br>
Survey data can be exported as shapefile if you have georeferenced at least a station.
There is a shapefile for the stations and one for the shots (both legs and splays).
If the survey contains disjoint pieces, a shapefile is exported for each pieces with a georeferenced station.
Data are corrected with the magnetic declination.
Each shapefile consists of three files: the data file (shp), the index file (shx), and the attributes file (dbf).
The files are zip-compressed and the zip is saved in the folder "shp" with extension ".shz".
<br><p>

The "stations" DBF contains only the field "name".<br><p>

The "shots" DBF contains the fields
<ul style="margin-top=0">
<li><i>type</i>: either "leg" or "splay"</li>
<li><i>from</i> station</li>
<li><i>to</i> station ("-" for splays)</li>
<li>shot <i>flag</i> as hex: 1-surface, 2-duplicate, 4-commented</li>
<li>shot <i>comment</i></li>
</ul><br>

Settings:
<ul style="margin-top=0">
<li><u>stations</u>: whether to export the stations file</li>
<li><u>splays</u>: whether to include the splays</li>
</ul><br><p>

<b>CSV</b> (.csv)<br>
Survey data can be exported as a list of records with comma-separated fields:
<ul style="margin-top=0">
<li>"from" and "to" stations</li>
<li>distance, azimuth, clino</li>
<li>if present the flag</li>
</ul><br>
Shot comments are not exported. A brief header is prepended to the data list.<br>

The survey raw data can be exported in CSV format. In this case each record (line) has
<ul style="margin-top=0">
<li>shot id</li>
<li>"from" and "to" stations</li>
<li>distance, azimuth, clino, roll</li>
<li>acceleration, magnetic field, dip</li>
<li>timestamp, type (DistoX or manual), DistoX-address</li>
</ul><br>

Settings:
<ul style="margin-top=0">
<li><u>raw data</u>: whether to export the raw data</li>
<li><u>separator</u>: fields separator (comma, pipe or tab)</li>
<li><u>EOL</u>: record separator (lf or cr+lf)</li>
</ul><br><p>


<b>DXF</b> (.dxf)<br>
Survey data are exported as 3D DXF (<i>LibreCAD</i>) with layers
<ul style="margin-top=0">
<li>stations</li>
<li>legs</li>
<li>splays</li>
</ul><br>
Data are corrected with the magnetic declination.<br><p>


<h4>SKETCH EXPORT</h4>

<b>Therion</b> (.th2)<br>
Sketches are exported in Therion format as one sketch per file, if exported from the <u>sketch window</u>,
or as a file containing all the sketches with the same view, plan or extended, if exported
from the <u>overview window</u>. In the latter there is a scrap for each sketch, and x-section scraps
are included if the automatic "section" points are enabled.
<br><p>


Settings:<ul style="margin-top=0">
<li>automatic <u>station-points</u>. [default: on].</li>
<li>add <u>splays</u> to the scrap (as lines of type "u:splay") [default: off].</li>
<li><u>point spacing</u> minimum distance between points on polylines. Intermediate points are not exported. Default 20 cm</li>
<li>export <u>scale</u>. Default 1:100</li>
</ul><p>

<!--
<u>Note</u>. With version 3.1 TopoDroid saves sketches "natively" in its binary format.<br>
Previous versions used Therion format.
The conversion from Therion to binary is "automatic" when you open a sketch: if TopoDroid does not find the binary file, it looks for the Therion file.<br>
From v. 4.1.2 TopoDroid does not load any more sketches in Therion format.<br>
-->

<b>cSurvey</b> (.csx)<br>
These exports contain both the plan and profile sketches, as well as the survey data.
When "section" points are define the section drawings are added at the point.<br>

The cSurvey "cave" attribute is set with the survey name, and the "branch" attribute with the sketch name (without the suffix 'p' or 's').
The midline legs and splays and the sketch items share these attributes.<br><p>

If your survey has only one sketch this is a complete export of your work (except for the x-sections).
If the survey has more than one sketch, you must export each sketch individually and merge the exports with <i>cSurvey</i>.<br><p>

The sketch items are distributed on suitable <i>cSurvey</i> layers.<br><p>

Settings:<ul style="margin-top=0">
<li><u>point spacing</u> maximum distance between interpolating points on smooth lines</li>
</ul><p>

<b>DXF</b> (.dxf)<br>
Sketches can be exported as 2D DXF (<i>LibreCAD</i>) files with layers for each point,
line and area type in addition to the layers of the survey data.
The sketch items in the 2D DXF lie in the Z=0 plane.<br><p>

<u>Note</u>. Sketch DXF export has been verified with <i>LibreCAD</i>;
compatibility with <i>AutoCAD</i>, and other CAD programs, is not guaranteed.<br><p>

Settings:<ul style="margin-top=0">
<li><u>section-point</u>: if a section line has the relative section point,
the drawing of the section is inserted in the export, at the "section" point</li>
<li><u>splay endpoints</u></li>
<li><u>point spacing</u> maximum distance between interpolating points on smooth lines. Default 20 cm</li>
<li>DXF version: 6 (dxf-9), 12 (dxf-13), or 16 (dxf-16). Default "6"</li>
</ul><p>

<b>SVG</b> (.svg)<br>
Sketches can be exported as SVG files.<br><p>

SVG settings:
<ul style="margin-top=0">
<li>Drawing <u>section-point</u>: if section points are automatically added to section lines,
the section drawing is inserted in the export, at the "section" point</li>
<li>automatic <u>station-points</u>: if enabled all stations are included in the export,
otherwise only the user-chosen stations are included</li>
<li><u>point spacing</u> maximum distance between interpolating points on smooth lines</li>
<li><u>grid</u> lines added to the export (cell size in the current grid units). Default no</li>
<li><u>line orientation</u> tick. Default no</li> 
<li><u>lines width</u>: labels, icons, lines (and area borders), grid lines, shots, orientation stroke</li>
</ul><p>

<b>Shapefile</b> (.shp)<br>
Sketches can be exported as shapefile, with stations, shots, and lines.
Each item has three files: the shape data file, the shape index file, and the database file.
The files comprising the shapefile export are zip-compressed and the zip file is saved in the
folder "shp" with extension ".shz".<br><p>

<b>Xtherion</b> (.xvi)<br>
The "xvi" export can be inserted as background image in xtherion.<br>
Lines of type "wall" are red, "slope" orange, "section" gray, all others are brown.
Area borders are black.
Point icons are rendered in a simplified way.
Label rendering supports only latin characters and digits and a few characters ('+', '-', '/', '_', '&gt;', '&lt;', '?').
Other characters are replaced by a "diamond".<br>
The grid cell are 1 m.
<br><p>

XVI settings are among Therion settings:
<ul style="margin-top=0">
<li>Drawing <u>section-point</u>: if section points are automatically added to section lines,
the section drawing is inserted in the xvi file, at the "section" point</li>
<li><u>grid</u> lines added to the export (cell size in the current grid units). Default no</li>
<li>export <u>scale</u>. Default 1:100</li>
</ul><p>


<b>PNG</b> (.png)<br>
Image file in PNG format is used only to export sketches.<br><p>

Settings:<ul style="margin-top=0">
<li><u>image resolution</u> (1 means that 1 m = 40 pixels). The PNG resolution that fits therion th2 export is 5.0.
If the system does not have enough memory to create the image at the set resolution, TopoDroid uses a smaller resolution until the export succeeds (or it gets so small that the program gives up trying).</li>
<li><u>background color</u>: three numbers between 0 (black) and 255 (saturated) for red, green, and blue, respectively.</li>
<li><u>grid</u>: whether to include or not</li>
<li><u>splays</u>: whether to include or not</li>
<li><u>stations</u>: whether to include or not</li>
</ul><p>

Finally the setting "levels" affects PNG exports: if levels are used the export will include only visible items.
<br><p>

<h4>CALIBRATION EXPORT</h4>

<a href="page_calib_import.htm">Calibrations</a> can be exported and imported as CSV files (.ccsv).<br><p>

<h4>IMPORT/EXPORT SETTINGS</h4>
<ul style="margin-top=0">
<li><b>PocketTopo</b> <i>import color-map</i>: map of PocketTopo colors to sketch item types.</li> 
<li><i>Estimate LR extend</i>: on import of <b>Compass/VisualTopo</b> files [yes]</li>
<li><i>Default data export format</i>: defines the default format to which data are exported. This file is automatically generated and inserted in the ZIP export.</li>
<li><i>Default sketch export format</i>: defines the default format to which sketches are exported. These files are automatically generated whenever a sketch is closed. This puts some extra load on the system, so you may opt for explicitly exporting sketches after the survey session.</li>
<li><b>Therion</b> <i>map commands</i> before or after the centerline block [after]</li>
<li><b>Therion</b> <i>auto-stations</i>: automatically add station points to the therion sketch file(s) [yes]. If you want to use the sketch files in therion they must have station points to define their scale. You can choose manually which point to add (by editing the sketch drawing), or let TopoDroid add the stations. The program will add all the stations that are "inside" the drawing (inside the drawing convex hull).</li>
<li><b>Therion</b> <i>u:splays</i> lines in Therion scraps [yes]</li>
<li><b>cSurvey/Compass</b> <i>survey prefix</i> to the stations [no]</li>
<li><b>Compass/TopoRobot/WinKarst/Polygon/VisualTopo</b>
  <ul>
  <li>minimum <i>splay-leg angle</i> for LRUD computation [0.0] This is also used in <b>Survex/Therion</b> if LRUD are required.</li>
  <li>minimun clino of splays used for up/down LRUD [0]</li>
  <li>maximum clino of splays used for left/right LRUD [90]</li>
  </ul>
</li>
<li><b>Compass swap LR</b>: Swap L and R on Compass export.</li>
<li><b>Survex/Topo</b> <i>line termination</i>: either Unix or Windows [Unix]</li>
<li><b>Survex</b> export with <i>named splay</i> TO stations [no]</li>
<li><b>Survex/Therion</b> export with <i>LRUD</i> lines [no]</li>
<li><b>SVG</b> export with <i>grid</i> [no]</li>
<li><b>SVG</b> export line orientation ticks [no]</li>
<li><b>SVG</b> stroke widths (labels, icons, lines, grids, shots, orientation ticks)</li>
<li><b>KML/GeoJSON</b> export with <i>stations</i> [yes]</li>
<li><b>KML/GeoJSON</b> export with <i>splays</i> [no]</li>
<li><b>PNG</b> <i>resolution</i> [1.5]. It can be a number between 1 and 10. The higher the bigger the image (if you set it too high the system may not have enough memory to create the PNG).</li> 
<li><b>PNG</b> <i>background color</i>: you can set the background color of PNG images by specifying the RGB values (three integers between 0 and 255).</li>
<li><b>DXF</b> sketch export <i>scale</i> [1.0]</li>
<li><b>DXF</b> export with <i>splay endpoints</i> [no]</li>
<li><i>DXF version</i> for the DXF export: either 6, 12, or 16. In version 6 DXF export bezier curves are replaced by polylines and areas do not have hatches. Version 12 and 16 DXF exports use splines and hatches, but they are still buggy.</li>
</ul>
<br><p>


<a href="page_finalmap.htm">The final map</a><br>
<p>

<a href="manual12.htm">&lt; Overview window</a> |
<a href="manual14.htm">Index &gt;</a>

</body></html>
